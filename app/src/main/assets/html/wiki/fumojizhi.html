<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>附魔机制</title>

  <link rel='stylesheet' id='publishable-mag-style-css' href='mycss1.css' type='text/css' media='all' />
</head>
<body>
    <h1  >
        附魔机制</h1>

    <div>
    <p>   
      本文章介绍附魔的机制。

      

</p>    
    




    <h2 >附魔基础</h2>
    <p>   


      当把一件可附魔的物品放上附魔台时，可用的附魔等级将会依据以下公式随机生成。附魔等级由附近书架的数量(最多15个)及附魔等级在附魔列表中所在的行数决定。
      
</p>     <p>   
 以下是可用附魔等级的计算步骤：
      </p>     <pre>可用附魔等级基数(base) = (1..8 + (b/2) + 0..b)
</pre>     <p>   
其中b 是附近书架的数量(≤15)，“x..y”表示在[x,y]闭区间内产生一个随机数。产生基数后，游戏会根据附魔等级所在的行数，进行第二步计算：
      
</p>     <pre>
第一行等级 = max (base / 3, 1)   
第二行等级 = (base × 2) / 3 + 1
第三行等级 = max (base, b × 2)
</pre>     <p>   
在正式版 1.3 前，可用附魔等级基数计算公式为 base = (1..5 + (b/2) + 0..b) ，并乘以“行列因数”(第一行为1⁄3，第二行为2⁄3，第三行为1)得到。最小的附魔等级与附魔台周围有效书架数目的一半相同。
      </p>     <p>   

 在正式版 1.1 前，上式的“(b/2)”项曾是“0..(b/2)”，这使得附魔等级随机性变大，刷出高等级附魔选项会耗费大量时间。同时，可用附魔等级的最低级固定在1，不会受书架数目的影响。
      </p>    <table>

<tr>
<th> 书架数目
</th>
<td> 0
</td>
<td> 1
</td>
<td> 2
</td>
<td> 3
</td>
<td> 4
</td>
<td> 5
</td>
<td> 6
</td>
<td> 7
</td>
<td> 8
</td>
<td> 9
</td>
<td> 10
</td>
<td> 11
</td>
<td> 12
</td>
<td> 13
</td>
<td> 14
</td>
<td> 15
</td></tr>
<tr>
<th> 最小等级(第一行)
</th>
<td> 1
</td>
<td> 1
</td>
<td> 1
</td>
<td> 1
</td>
<td> 1
</td>
<td> 1
</td>
<td> 1
</td>
<td> 1
</td>
<td> 1
</td>
<td> 1
</td>
<td> 2
</td>
<td> 2
</td>
<td> 2
</td>
<td> 2
</td>
<td> 2
</td>
<td> 2
</td></tr>
<tr>
<th> 最大等级(第三行)
</th>
<td> 8
</td>
<td> 9
</td>
<td> 11
</td>
<td> 12
</td>
<td> 14
</td>
<td> 15
</td>
<td> 17
</td>
<td> 18
</td>
<td> 20
</td>
<td> 21
</td>
<td> 23
</td>
<td> 24
</td>
<td> 26
</td>
<td> 27
</td>
<td> 29
</td>
<td> 30
</td></tr></table> <p>   

 在创造模式中，附魔不需要经验等级。

      </p>     


    




    <h2 >书架的放置</h2>
    <p>   

      附魔台附近的书架可以提高可用的附魔等级。在预览版12w22a中，若附魔台周围没有书架，则可用附魔等级最高只会到8级。
      </p>     <p>   

 有效的书架必须距离附魔台2个方块远，且必须与附魔台处于同一或高1个方块的高度。
      </p>     <p>   

 书架和附魔台之间的空间必须是空气(火把与雪也不允许)
      
</p>     <p>   
 如下图所示:
      </p>     <p>   
<img src="https://raw.githubusercontent.com/wiki/hesuxiang/mincreafting/wiki/img/fumojizhi1.png" />
<br /> 俯视 </p>   <p>   
<img src="https://raw.githubusercontent.com/wiki/hesuxiang/mincreafting/wiki/img/fumojizhi2.png" />
<br /> 侧视 </p>     <p>   

      
由于只需要15个书架即可达到最大附魔等级，所以书架的排列有很多种方法。
      </p>  


    



 <p><b> 方法1</b></p> 
 
       <p>   

      一种最简单的方法是用一层书架围着附魔台绕上一圈：
      
 <br />
<img src="https://raw.githubusercontent.com/wiki/hesuxiang/mincreafting/wiki/img/fumojizhi3.png" />
 
</p>   

    


 <p><b> 方法2</b></p> 
 
      <p>   

      另外一种方法则是做一个“图书角”。这种方法使用了16个书架，比需要的还要多。
      
</p>     <p>   
第一层 <br />
<img src="https://raw.githubusercontent.com/wiki/hesuxiang/mincreafting/wiki/img/fumojizhi4.png" /> <br />
 <br />第二层 <br />
<img src="https://raw.githubusercontent.com/wiki/hesuxiang/mincreafting/wiki/img/fumojizhi5.png" />

</p>    

    



 <p><b> 方法3</b></p> 
    
 <p>   
      另外一个“图书角”，书架放两层。这种方法使用了16个书架，比需要的还要多。
 <br />
<img src="https://raw.githubusercontent.com/wiki/hesuxiang/mincreafting/wiki/img/fumojizhi6.png" />
</p>     <p>   

 如果需要限制最大附魔等级，一种简单的方法就是往附魔台与书架之间的空间中插火把禁用部分书架。把火把拿下可以重新恢复最大的附魔等级。
      </p>     <p>   

 另外要注意的是，要检查附魔区域的环境，并保证书架与附魔台之间的绝对空隙。例如在覆雪生物群系中，雪可以把所有书架都无效化。因此，除非你希望得到较小的附魔等级，则在附魔前要进行仔细的检查和清理。
      </p>  


    




    <h2 >魔咒是如何选择出来的</h2>
       <p>   

      “魔咒等级”是某一魔咒所需的经验级别(在按钮上的绿色数字)。
      </p>     <p>   

 “魔咒威力”是某一特定魔咒的力量。例如，“锋利IV”有4点威力。
      </p>     <p>   

 魔咒的挑选有三个步骤。
      
</p>    

    


 <p><b> 第一步 - 对附魔等级加入调节值</b></p> 
 
    
  <p>  

      首先游戏会把两个调节值加入到被选的附魔等级中。每个调节值会被限制在一定的范围内，数字接近范围中央的会比靠近两端的更常见。
      </p>     <p>   
 第一调节值是基于附魔对象的“附魔能力”，这取决于该物品的材料和类型(见下表)。游戏会在0至附魔能力的一半(实际上，游戏会先将附魔能力除以4，四舍五入为整数后再乘以2)之间随机挑选一个数字，然后将这个数字和1加到附魔等级里。此时，弓的附魔能力是1。然后，这个随机数会经过三角形分布处理，使得最终结果靠近附魔能力一半的几率远大于靠近极值的几率。 
</p>     <p style="text-align:center">   
<b>修改后的附魔等级 = 附魔等级 + 随机值(0, 附魔能力 / 4 * 2) + 1<br /> (每步计算完毕后四舍五入)</b></p>   
<table  style="text-align: center;">

<tr>
<th>材料
</th>
<th>对应盔甲的附魔能力
</th>
<th>对应剑/工具的附魔能力
</th></tr>
<tr>
<td>木
</td>
<td>不可用
</td>
<td>15
</td></tr>
<tr>
<td>皮革
</td>
<td>15
</td>
<td>不可用
</td></tr>
<tr>
<td>石
</td>
<td>不可用
</td>
<td>5
</td></tr>
<tr>
<td>铁
</td>
<td>9
</td>
<td>14
</td></tr>
<tr>
<td>链(链甲)
</td>
<td>12
</td>
<td>不可用
</td></tr>
<tr>
<td>钻石
</td>
<td>10
</td>
<td>10
</td></tr>
<tr>
<td>金
</td>
<td>25
</td>
<td>22
</td></tr></table>
   <p>   
 接着，Minecraft会在0.85和1.15之间挑选一个值，并再次经过三角形分布处理。修改后的附魔等级会乘以这个值(因此它可以增加或减少最多15％)，然后四舍五入至整数，得到最终的等级调节值。
      

</p>   
    

 <p><b>伪代码 </b></p> 
<pre>// 返回一个区间为[0,n-1)的随机整数
function randomInt(n);

// 返回一个区间为[0,1)的一个随机实数
function randomFloat();

// 利用三角随机分布，生成一个区间为[1,1+(附魔能力/2))的随机数
enchantability_2 = enchantability / 2;
int rand_enchantability = 1 + randomInt(enchantability_2 / 2 + 1) + randomInt(enchantability_2 / 2 + 1);

// 选择附魔能级
int k = chosen_enchantment_level + rand_enchantability;

// 0.85至1.15之间的附魔奖励
float rand_bonus_percent = (randomFloat() + randomFloat() - 1) * 0.15 + 1;

// 最终计算得到等级
int final_level = (int)(k * (1 + rand_bonus_percent) + 0.5);
</pre> 

 <p><b> 第二步 - 寻找可能的魔咒</b></p> 
 
      <p>   

<img src="https://raw.githubusercontent.com/wiki/hesuxiang/mincreafting/wiki/img/fumojizhi7.png" />
<br />
一把附有几个魔咒的剑。(在正式版 1.3 后，锋利 V 无法附到钻石剑上。)

      </p>     <p>   

现在，以等级调节值为基础，游戏会先列出所有可应用于目标物品的附魔类型及其威力(候选表)，以便之后的挑选。
      </p>     <p>   

 魔咒等级表中列出了每一种魔咒类型的可用等级及其威力。对于每一级威力的每种魔咒，都有与其规定的等级调节值范围。当等级调节值符合某级威力某个魔咒的等级调节值范围时，这个魔咒进入候选表；如果等级调节值同时包含于同一个魔咒不同级别威力的等级调节值范围内时，较高等级的魔咒进入候选表。例如，剑的“锋利 I”和“锋利 II”魔咒的等级调节值范围分别为 1 - 21 和 12 - 32 ，则当等级调节值为10时，“锋利 I”进入候选列表；当等级调节值为15时，“锋利 II”则会进入候选列表。Enchantview
    </p>     <p>     Mod 可以查看将要附魔的物品能附上什么魔咒。
      


    
</p>    


 <p><b> 第三步 - 从候选表中选择魔咒</b></p>  
     <p>   

      现在它有了该物品的附魔候选表，游戏会从它们之中选择一些会最后应用到的附魔。
      
</p>     <p>   
 最终附上的魔咒至少会有一个，第一个魔咒会从“权重”名单中被挑选出来——权重越高的魔咒，选中的机会越高。
      
</p>     <p style="text-align:center">   
<b>P(魔咒)=(魔咒权重)/(∑i=1可能的魔咒的数量〖魔咒权重i〗)</b></p>     <p>   

      
</p>  
<table style="text-align:center">
<tr>
<th> 盔甲魔咒
</th>
<th> 权重
</th>
<th> 宝藏型
</th></tr>
<tr>
<td> 保护
</td>
<td> 10
</td>
<td style="background-color: #5DCC5D; color: #004100;"> 否
</td></tr>
<tr>
<td> 摔落保护
</td>
<td> 5
</td>
<td style="background-color: #5DCC5D; color: #004100;"> 否
</td></tr>
<tr>
<td> 火焰保护
</td>
<td> 5
</td>
<td style="background-color: #5DCC5D; color: #004100;"> 否
</td></tr>
<tr>
<td> 弹射物保护
</td>
<td> 5
</td>
<td style="background-color: #5DCC5D; color: #004100;"> 否
</td></tr>
<tr>
<td> 水下速掘
</td>
<td> 2
</td>
<td style="background-color: #5DCC5D; color: #004100;"> 否
</td></tr>
<tr>
<td> 爆炸保护
</td>
<td> 2
</td>
<td style="background-color: #5DCC5D; color: #004100;"> 否
</td></tr>
<tr>
<td> 水下呼吸
</td>
<td> 2
</td>
<td style="background-color: #5DCC5D; color: #004100;"> 否
</td></tr>
<tr>
<td> 深海探索者
</td>
<td> 2
</td>
<td style="background-color: #5DCC5D; color: #004100;"> 否
</td></tr>
<tr>
<td> 冰霜行者
</td>
<td> 2
</td>
<td style="background-color: #FF5757; color: #700005;"> 是
</td></tr>
<tr>
<td> 荆棘
</td>
<td> 1
</td>
<td style="background-color: #5DCC5D; color: #004100;"> 否
</td></tr>
<tr>
<td> 绑定诅咒
</td>
<td> 1
</td>
<td style="background-color: #FF5757; color: #700005;"> 是
</td></tr>
<tr>
<th> 剑魔咒
</th>
<th> 权重
</th>
<th> 宝藏型
</th></tr>
<tr>
<td> 锋利
</td>
<td> 10
</td>
<td style="background-color: #5DCC5D; color: #004100;"> 否
</td></tr>
<tr>
<td> 节肢杀手
</td>
<td> 5
</td>
<td style="background-color: #5DCC5D; color: #004100;"> 否
</td></tr>
<tr>
<td> 击退
</td>
<td> 5
</td>
<td style="background-color: #5DCC5D; color: #004100;"> 否
</td></tr>
<tr>
<td> 亡灵杀手
</td>
<td> 5
</td>
<td style="background-color: #5DCC5D; color: #004100;"> 否
</td></tr>
<tr>
<td> 火焰附加
</td>
<td> 2
</td>
<td style="background-color: #5DCC5D; color: #004100;"> 否
</td></tr>
<tr>
<td> 抢夺
</td>
<td> 2
</td>
<td style="background-color: #5DCC5D; color: #004100;"> 否
</td></tr>
<tr>
<th> 工具
</th>
<th> 权重
</th>
<th> 宝藏型
</th></tr>
<tr>
<td> 效率
</td>
<td> 10
</td>
<td style="background-color: #5DCC5D; color: #004100;"> 否
</td></tr>
<tr>
<td> 耐久
</td>
<td> 5
</td>
<td style="background-color: #5DCC5D; color: #004100;"> 否
</td></tr>
<tr>
<td> 时运
</td>
<td> 2
</td>
<td style="background-color: #5DCC5D; color: #004100;"> 否
</td></tr>
<tr>
<td> 精准采集
</td>
<td> 1
</td>
<td style="background-color: #5DCC5D; color: #004100;"> 否
</td></tr>
<tr>
<th> 弓魔咒
</th>
<th> 权重
</th>
<th> 宝藏型
</th></tr>
<tr>
<td> 力量
</td>
<td> 10
</td>
<td style="background-color: #5DCC5D; color: #004100;"> 否
</td></tr>
<tr>
<td> 火矢
</td>
<td> 2
</td>
<td style="background-color: #5DCC5D; color: #004100;"> 否
</td></tr>
<tr>
<td> 冲击
</td>
<td> 2
</td>
<td style="background-color: #5DCC5D; color: #004100;"> 否
</td></tr>
<tr>
<td> 无限
</td>
<td> 1
</td>
<td style="background-color: #5DCC5D; color: #004100;"> 否
</td></tr>
<tr>
<th> 钓鱼竿魔咒
</th>
<th> 权重
</th>
<th> 宝藏型
</th></tr>
<tr>
<td> 海之眷顾
</td>
<td> 2
</td>
<td style="background-color: #5DCC5D; color: #004100;"> 否
</td></tr>
<tr>
<td> 饵钓
</td>
<td> 2
</td>
<td style="background-color: #5DCC5D; color: #004100;"> 否
</td></tr>
<tr>
<th> 能附在“任何物品”的魔咒
</th>
<th> 权重
</th>
<th> 宝藏型
</th></tr>
<tr>
<td> 经验修补
</td>
<td> 2
</td>
<td style="background-color: #FF5757; color: #700005;"> 是
</td></tr>
<tr>
<td> 消失诅咒
</td>
<td> 1
</td>
<td style="background-color: #FF5757; color: #700005;"> 是
</td></tr></table>

   <p>   
 第一个魔咒被选中后，根据以下算法来判断是否得到更多魔咒：
</p>   
      <ol>
        <li>将等级调节值除以2，并四舍五入。(这不影响魔咒候选表，因为候选表在第二步已经确定。)</li>
        <li>以 P=(修改后的等级调节值+1)/50 的几率决定是否选择额外的魔咒。</li>
        <li>选择额外的魔咒后，删除表中任何与先前选择附魔相冲的魔咒。</li>
        <li>从剩下的魔咒候选表中挑选一个魔咒(像之前一样，以权重为基准)并将其加入到该物品。</li>
        <li>重复第一步。</li>
      </ol>

    


 <h1 style="background-color: #FFCCCC; color: #000000;"> 相冲的魔咒</h1>
 
      <p>   


      一些魔咒会与其他魔咒相冲，因此不能附到同一物品上，有效地减低玩家拥有过强武器/盔甲的可能性。
      
</p>     <p>   
 魔咒相冲的规则是：
</p>     
      <ul>
        <li>每个魔咒与本身相冲。(所以你不能得到有两个相同魔咒的工具。)</li>
        <li>所有保护类魔咒相互冲突，所以一个物品只能有一个。(在程序代码中，摔落保护是一种保护类魔咒，但它不与其他保护类魔咒发生冲突。)</li>
        <li>所有伤害类魔咒(锋利、亡灵杀手和节肢杀手)相互冲突。</li>
        <li>“精准采集”和“时运”也会互相冲突。(在通过使用物品修改器得到的同时拥有“时运”与“精准采集”魔咒的镐中，“时运”会失效，因为“精准采集”的存在导致根本就不能采到方块的掉落资源，只能够得到方块本身。)</li>
        <li>“深海探索者”和“冰霜行者”也会互相冲突。</li>
       <li> “经验修补”和“无限”也会互相冲突。[仅Java版]</li>
      </ul>
    



 <h2>以钻石镐30级的附魔为例 </h2>
 
    
 <p>  
      <b>第一步</b></p>     <p>   
 首先计算附魔调节值，钻石无论剑/工具/盔甲的附魔能力都为10，则10/4=2.5，四舍五入得3，再3*2=6，则系统会在0~6范围内随机取一个值，再+1，即为修改后的附魔等级，范围在31~37
      </p>     <p>   

 接着乘以0.85~1.15间的一个随机值，得到最终的等级调节值，范围为26.35~42.55，四舍五入得26~43，
      </p>     <p>   

 而你得到的等级调节值是范围内的一个值(由于两次三角算法所以靠近中间值35的概率比靠近极值大)，这个值将会影响魔咒候选表和是否获得更多魔咒。
</p>     <p>   
      

<b>第二步</b></p>     <p>   
 以此为基准通过魔咒等级表来选择入选魔咒</p>     <p>   
      
</p>   <table style="text-align: center;">

<tr>
<th rowspan="2"> 工具魔咒
</th>
<th colspan="5"> 修改后的附魔等级
</th></tr>
<tr>
<th> I
</th>
<th> II
</th>
<th> III
</th>
<th> IV
</th>
<th> V
</th></tr>
<tr>
<td>  效率
</td>
<td> 1–51
</td>
<td> 11–61
</td>
<td> 21–71
</td>
<td> 31–81
</td>
<td> 41–91
</td></tr>

<tr>
<td>  精准采集
</td>
<td> 15–65
</td>
<td> —
</td>
<td> —
</td>
<td> —
</td>
<td> —
</td></tr>

<tr>
<td>  耐久
</td>
<td> 5–55
</td>
<td> 13–63
</td>
<td> 21–71
</td>
<td> —
</td>
<td> —
</td></tr>

<tr>
<td>  时运
</td>
<td> 15–65
</td>
<td> 24–74
</td>
<td> 33–83
</td>
<td> —
</td>
<td> —
</td></tr>

</table>     <p>   

从表中查出有可能的魔咒(括号内为对应魔咒等级范围)为：效率III(21-71),效率IV(31-81),效率V(41-91),精准采集(15-65),耐久III(21-71),时运II(24-74),时运III(33-83)
即附魔等级调节值与对应出现在候选表中的魔咒为(特别的，锋利V是30级钻石附魔唯一无法得到的魔咒，因为其最低等级需要45) </p>  
<table style="text-align: center;">

<tr>
<th> 附魔等级调节值
</th>
<th> 26-30
</th>
<th> 31-32
</th>
<th> 33-40
</th>
<th> 41-43
</th></tr>
<tr>
<td align="center"> 效率 </td>
<td> III </td>
<td> IV </td>
<td> IV </td>
<td> V
</td></tr>
<tr>
<td align="center"> 时运 </td>
<td> II </td>
<td> II </td>
<td> III </td>
<td> III
</td></tr>
<tr>
<td align="center"> 耐久 </td>
<td> III </td>
<td> III </td>
<td> III </td>
<td> III
</td></tr>
<tr>
<td align="center"> 精准采集 </td>
<td> I </td>
<td> I </td>
<td> I </td>
<td> I
</td></tr></table>


   <p>   

<b>第三步</b></p>     <p>   
 决定在候选表的四个魔咒中具体附魔哪一个，就需要计算各魔咒权重，查表知效率为10，精准采集为1，耐久为5，时运为2 则各个附魔(与威力无关)的概率为，效率10/(10+1+5+2)=5/9，精准采集1/18，耐久5/18，时运1/9
      </p>     <p>   

 如此便得到了第一个附魔
      
</p>   

    



 <p><b>判断是否得到更多魔咒 </b></p>  
      <p>   

      等级调节值除以2，得到值范围13~21.5，四舍五入得13~22
      </p>     <p>   

 注意候选表已经不再受等级调节值影响，即如有第二个魔咒为耐久则依旧必然为耐久III。
      </p>     <p>   

 获得第二个魔咒的概率为P=(修改后的等级调节值+1)/50，概率范围为28%~46%。
      </p>     <p>   

 接下来候选表中删掉已获得附魔和冲突的——工具中只有精准采集和时运冲突，再次通过权重计算接下来获得的魔咒概率，并得到第二个魔咒。
      </p>     <p>   

 等级调节值再次除以2，得到值范围6.5~11，四舍五入得7~11 获得第三个魔咒的概率范围为16%~24%。
      </p>     <p>   

 再重复删掉候选表中已有和冲突的附魔，如此时候选表只剩时运和精准采集，则获得时运的概率为2/3，精准采集概率为1/3，其他情况则只剩下一个候选魔咒，必然获得该魔咒。 而因此镐最多获得三个魔咒，之后即使得到第四个附魔机会，也会因候选表中没有魔咒而无效(而剑是有可能获得五个魔咒的，虽然概率极低)。
      
</p>     <p>   
 如此便得到了最终的附魔钻石镐。
      
 </p>    
 
 
<h2>附魔模拟器</h2>
    
    <p>
附魔系统的测试与模拟系统： <a href="http://github.com/Zazcallabah/mce/downloads">http://github.com/Zazcallabah/mce/downloads</a></p>  
   <p>   在线版附魔概率计算器：
   </p>     <p> 1.8版本：<a href="http://www.minecraftenchantmentcalculator.com/rev6/ ">http://www.minecraftenchantmentcalculator.com/rev6/ </a>
   </p>     <p> 1.7版本：<a href="http://www.minecraftenchantmentcalculator.com/rev5/">http://www.minecraftenchantmentcalculator.com/rev5/</a>
     </p>  
	 
	 <p> 
<img src="https://raw.githubusercontent.com/wiki/hesuxiang/mincreafting/wiki/img/fumojizhi8.png" />
<br />钻石工具所有可能附魔列表。
</p>
	 
 <p><br/></p></div>
</body>

</html>
